<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,500;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link rel="icon" href="./IMG/ico.png">
    <title>Piano</title>
</head>

<body>
  <!-- A('./sounds/A.wav') -->
 
    <div class="keys">
      <div id="header">
        <h1>Marc Ribot y Los Cubanos Postizos</h1>
        <!-- <h3>Play along</h3> -->
      </div>
            <div data-key="81" id="key1" class="key" ontouchstart="note1();">
              <kbd>Q</kbd>
                
              </div>
              <div data-key="83" class="key" ontouchstart="note2();">
                <kbd>S</kbd> 
                
              </div>
              <div data-key="68" class="key" ontouchstart="note3();">
                <kbd>D</kbd>
                
              </div>  
              <div data-key="70" class="key" ontouchstart="note4();">
                <kbd>F</kbd>
                
              </div>
              <div data-key="71" class="key" ontouchstart="note5();">
                <kbd>G</kbd>
               
              </div>
              <div data-key="72" class="key" ontouchstart="note6();">
                <kbd>H</kbd>
             
              </div>
              <div data-key="74" class="key" ontouchstart="note7();">
                <kbd>J</kbd>
                
              </div>
        
         
      </div>
     
    <audio id="main_song" src="./sounds/I.mp3" autoplay=0></audio> 

    <audio id="note1" class="note" data-key="81" src="./sounds/A.wav"></audio>
    
    <audio id="note2"  class="note"  data-key="83" src="./sounds/B.wav"></audio>
    
    <audio id="note3"  class="note"  data-key="68" src="./sounds/C.wav"></audio>
    <audio id="note4"  class="note"  data-key="70" src="./sounds/D.wav"></audio>
    
    <audio id="note5"  class="note"  data-key="71" src="./sounds/E.wav"></audio>
    
    <audio id="note6"  class="note"  data-key="72" src="./sounds/F.wav"></audio>
    
    <audio id="note7"  class="note"  data-key="74" src="./sounds/G.wav"></audio>    

    <!-- need to use on touch / touchstart whatever it is !-->
    <div id="player">
      <img class="previous" data-key="37" src="./IMG/next.png" height="32px" width="32px" ontouchstart="changeAudio();">
      <div class="pp" data-key="32" ontouchstart="playPause();"><img src="./IMG/pp.png" height="32px" width="32px"></div>
      <img class="next" data-key="39" src="./IMG/next.png" height="32px" width="32px" ontouchstart="changeAudio();">
    </div>

    <img class="reload" ontouchstart="backToStart()" src="./IMG/reload.png" height="32px" width="32px">
</body>

<script>
function removeTransition(e) {
    
     this.classList.remove('playing');
  }

   const keys = document.querySelectorAll('.key');
  //  keys.forEach(key => key.addEventListener('touchend', removeTransition)); to fast for phone
   keys.forEach(key => key.addEventListener('transitionend', removeTransition));

// WORKAROUND TO STOP SOUNDS ON PAGE LOAD ....

document.addEventListener("DOMContentLoaded", function() {
  const audio = document.getElementById('main_song');
  const note1 = document.getElementById('note1');
  const note2 = document.getElementById('note2');
  const note3 = document.getElementById('note3');
  const note4 = document.getElementById('note4');
  const note5 = document.getElementById('note5');
  const note6 = document.getElementById('note6');
  const note7 = document.getElementById('note7');
  const keys = document.querySelectorAll('.key');
  keys.classList.remove('playing');
  audio.currentTime = 0;
  audio.pause();
  note1.currentTime = 0;
  note1.pause();
  note2.currentTime = 0;
  note2.pause();
  note3.currentTime = 0;
  note3.pause();
  note4.currentTime = 0;
  note4.pause();
  note5.currentTime = 0;
  note5.pause();
  note6.currentTime = 0;
  note6.pause();
  note7.currentTime = 0;
  note7.pause();
});

function backToStart() {
  const audio = document.getElementById('main_song');
  const note1 = document.getElementById('note1');
  const note2 = document.getElementById('note2');
  const note3 = document.getElementById('note3');
  const note4 = document.getElementById('note4');
  const note5 = document.getElementById('note5');
  const note6 = document.getElementById('note6');
  const note7 = document.getElementById('note7');
  audio.currentTime = 0;
  audio.pause();
  
}

backToStart();

let a = 1;

function changeAudio() {
  const audio = document.getElementById('main_song');
  const note1 = document.getElementById('note1');
  const note2 = document.getElementById('note2');
  const note3 = document.getElementById('note3');
  const note4 = document.getElementById('note4');
  const note5 = document.getElementById('note5');
  const note6 = document.getElementById('note6');
  const note7 = document.getElementById('note7');
  if (a==1) {
    audio.src = './sounds/I.mp3'; // C 

    note1.src = './sounds/A.wav';
    note2.src = './sounds/B.wav';
    note3.src = './sounds/C.wav';
    note4.src = './sounds/D.wav';
    note5.src = './sounds/E.wav';
    note6.src = './sounds/F.wav';
    note7.src = './sounds/G.wav';
    a++;
    
  }
  else if (a==2) {
    audio.src = './sounds/II.mp3'; // E

    note1.src = './sounds/Ab.wav';
    note2.src = './sounds/A.wav';
    note3.src = './sounds/B.wav';
    note4.src = './sounds/Db.wav';
    note5.src = './sounds/Eb.wav';
    note6.src = './sounds/E.wav';
    note7.src = './sounds/Gb.wav';
    a++;
  }
  else if (a==3) {
    audio.src = './sounds/III.mp3'; // E

    note1.src = './sounds/A.wav';
    note2.src = './sounds/Bb.wav';
    note3.src = './sounds/Db.wav';
    note4.src = './sounds/D.wav';
    note5.src = './sounds/E.wav';
    note6.src = './sounds/F.wav';
    note7.src = './sounds/G.wav';
    a = 1;
  }


  document.getElementById('main_song').load();
  document.getElementById('note1').load();
  document.getElementById('note2').load();
  document.getElementById('note3').load();
  document.getElementById('note4').load();
  document.getElementById('note5').load();
  document.getElementById('note6').load();
  document.getElementById('note7').load();
}


changeAudio();

function playPause() {
      const a = document.getElementById('main_song'); 
      if(a.paused) {
        a.play();
      }
      else {
        a.pause();
        // a.currentTime = 0; for stop button
      }


}
playPause();

function note1() {
  const noteI = document.getElementById('note1');
  const key = document.getElementsByClassName("key")[0]; //it's an array duh
  noteI.currentTime=0;
  noteI.volume = 0.6;
  noteI.play();
  key.classList.add('playing');
 

}
note1();

function note2() {
  const noteII = document.getElementById('note2');
  const key = document.getElementsByClassName("key")[1];
  noteII.currentTime=0;
  noteII.volume = 0.6;
  noteII.play();
  key.classList.add('playing');

  
}
note2();

function note3() {
  const noteIII = document.getElementById('note3');
  const key = document.getElementsByClassName("key")[2];
  noteIII.currentTime=0;
  noteIII.volume = 0.6;
  noteIII.play();
  key.classList.add('playing');
}
note3();

function note4() {
  const noteIV = document.getElementById('note4');
  const key = document.getElementsByClassName("key")[3];
  noteIV.currentTime=0;
  noteIV.volume = 0.6;
  noteIV.play();
  key.classList.add('playing');
}
note4();

function note5() {
  const noteV = document.getElementById('note5');
  const key = document.getElementsByClassName("key")[4];
  noteV.currentTime=0;
  noteV.volume = 0.6;
  noteV.play();
  key.classList.add('playing');
}
note5();

function note6() {
  const noteVI = document.getElementById('note6');
  const key = document.getElementsByClassName("key")[5];
  noteVI.volume = 0.4;
  noteVI.currentTime=0;
  noteVI.play();
  key.classList.add('playing');
}
note6();

function note7() {
  const noteVII = document.getElementById('note7');
  const key = document.getElementsByClassName("key")[6];
  noteVII.volume = 0.4;
  noteVII.currentTime=0;
  noteVII.play();
  key.classList.add('playing');
}
note7();







// window.addEventListener('mouseover', touchPlay);
// function touchPlay() {
  

// }

     window.addEventListener('keydown', playSound);
   

     function playSound(e) {
     const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`); 
     const key = document.querySelector(`.key[data-key="${e.keyCode}"]`); 
     if (!audio) return; // stop from running
     audio.currentTime = 0; // rewind audio to start !
     audio.play();
     key.classList.add('playing');
   }
  

   



// const main = new Audio("./sounds/I.mp3"); 
// const playing = false;
// document.body.onkeydown = function (e){
//     if(e.keyCode == 32 && !playing){
//         if ( main.paused ) {
//               main.play();
//           } else {
//               main.pause();
//     }
//     }
// }

// const keypress = document.querySelectorAll('.key');

//   keypress.forEach(key => key.addEventListener('mouseover', toggleOpen));
  

//   function toggleOpen() {
//     this.classList.toggle('open');    
      
//   }
//   keypress.forEach(key => key.addEventListener('mouseout', toggleClose));

//   function toggleClose() {
//     this.classList.remove('open');      
//   }

// const C = new Audio("./sounds/C.wav");
// const Db = new Audio("./sounds/Db.wav");
// const D = new Audio("./sounds/D.wav");
// const Eb = new Audio("./sounds/Eb.wav");
// const E = new Audio("./sounds/E.wav");
// const F = new Audio("./sounds/F.wav");
// const Gb = new Audio("./sounds/Gb.wav");
// const G = new Audio("./sounds/G.wav");
// const Ab = new Audio("./sounds/Ab.wav");
// const A = new Audio("./sounds/A.wav");
// const Bb = new Audio("./sounds/Bb.wav");
// const B = new Audio("./sounds/B.wav");

// const playing = false;
// document.body.onkeydown = function (e){
//     if(e.keyCode == 81 && !playing){
//         C.play();
//         playing=true;
//     } if(e.keyCode == 90 && !playing){
//         Db.play();
//         playing=true;
//     } if(e.keyCode == 83 && !playing){
//         D.play();
//         playing=true;
//     } if(e.keyCode == 69 && !playing){
//         Eb.play();
//         playing=true;
//     } if(e.keyCode == 68 && !playing){
//         E.play();
//         playing=true;
//     } if(e.keyCode == 70 && !playing){
//         F.play();
//         playing=true;
//     } if(e.keyCode == 84 && !playing){
//         Gb.play();
//         playing=true;
//     } if(e.keyCode == 71 && !playing){
//         G.play();
//         playing=true;
//     } if(e.keyCode == 89 && !playing){
//         Ab.play();
//         playing=true;
//     } if(e.keyCode == 72 && !playing){
//         A.play();
//         playing=true;
//     } if(e.keyCode == 85 && !playing){
//         Bb.play();
//         playing=true;
//     } if(e.keyCode == 74 && !playing){
//         B.play();
//         playing=true;
//     }
// }    


// document.body.onkeyup = function (e){
//     if(e.keyCode == 81){
//         C.pause();
//         playing=false;
//     } }
 
    

</script>
</html>
